<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>WebSocket Chat</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    #ai { white-space: pre-wrap; color: #0a7; margin-top: 10px; }
  </style>
</head>

<body>
<h2>AI Chat (WebSocket)</h2>

<input id="q" placeholder="Ask something..." style="width:300px">
<button onclick="send()">Send</button>

<div id="ai"></div>

<script>
const socket = new WebSocket("ws://127.0.0.1:8000/ws/chat/");

socket.onmessage = function(event) {
  const data = JSON.parse(event.data);

  if (data.type === "chunk") {
    document.getElementById("ai").textContent += data.content;
  }
};

function send() {
  document.getElementById("ai").textContent = "";
  socket.send(JSON.stringify({
    message: document.getElementById("q").value
  }));
}
</script>
<script>
const token = "{{ jwt_token }}";  // injected from backend

const socket = new WebSocket(
  "ws://127.0.0.1:8000/ws/chat/?token=" + token
);
</script>

</body>
</html>





